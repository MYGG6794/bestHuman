Log initialized at 2025/6/13 17:33:24
2025-06-13 17:33:24 [INFO] 应用程序启动中...
2025-06-13 17:33:24 [INFO] MainForm 构造函数开始。
2025-06-13 17:33:24 [INFO] 加载应用程序设置。
2025-06-13 17:33:24 [INFO] 主窗口透明修复 - BackColor: Color [Magenta], TransparencyKey: Color [Magenta]
2025-06-13 17:33:24 [INFO] 注册全局热键 Alt+F10: 失败
2025-06-13 17:33:24 [INFO] 注册全局热键 Alt+S: 成功
2025-06-13 17:33:24 [INFO] 设置窗口置顶: True
2025-06-13 17:33:24 [INFO] MainForm 窗体被激活
2025-06-13 17:33:24 [INFO] 启用点击穿透: True
2025-06-13 17:33:24 [INFO] 点击穿透模式下重新注册全局热键
2025-06-13 17:33:24 [INFO] 已注销所有全局热键
2025-06-13 17:33:24 [INFO] 注册全局热键 Alt+F10: 失败
2025-06-13 17:33:24 [INFO] 注册全局热键 Alt+S: 成功
2025-06-13 17:33:24 [INFO] 设置窗口所有者: MainForm
2025-06-13 17:33:24 [WARNING] 语音识别初始化失败（可能是因为没有麦克风）: Cannot find the requested data item, such as a data key or value.
2025-06-13 17:33:24 [INFO] 尝试连接到 WebSocket 服务器: ws://localhost:8080
2025-06-13 17:33:24 [WARNING] 语音识别初始化失败（可能是因为没有麦克风）: Cannot find the requested data item, such as a data key or value.
2025-06-13 17:33:24 [INFO] MainForm 构造函数结束。
2025-06-13 17:33:24 [INFO] 窗口加载完成，重新设置透明
2025-06-13 17:33:24 [INFO] 窗口显示后重新设置透明
2025-06-13 17:33:24 [INFO] WebView2透明背景配置完成
2025-06-13 17:33:24 [INFO] WebView2 初始化完成
2025-06-13 17:33:26 [INFO] KeyDown event triggered. KeyCode: Menu, Modifiers: Alt, KeyData: Menu, Alt, isAltKeyPressed: False, 设置窗口可见:False
2025-06-13 17:33:26 [INFO] Alt key pressed, setting flag to true
2025-06-13 17:33:26 [INFO] 全局热键被触发，ID: 2
2025-06-13 17:33:26 [INFO] 通过全局热键触发设置窗口切换
2025-06-13 17:33:26 [INFO] ToggleSettingsWindow调用：当前窗口状态 - 存在:True，可见:False，已释放:False
2025-06-13 17:33:26 [INFO] 显示设置窗口并激活。
2025-06-13 17:33:27 [INFO] 设置窗口可见性改变: True
2025-06-13 17:33:27 [INFO] 设置界面已显示
2025-06-13 17:33:27 [INFO] 设置界面已激活
2025-06-13 17:33:28 [ERROR] ERROR: WebSocket 连接失败: Unable to connect to the remote server
Exception: Unable to connect to the remote server
StackTrace:    at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.ClientWebSocket.ConnectAsyncCore(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken)
   at CoreApplication.WebSocketClient.ConnectAsync(String uri) in D:\Projects\bestHuman\bestHuman\CoreApplication\WebSocketClient.cs:line 56
2025-06-13 17:33:28 [ERROR] ERROR: WebSocket 错误: 连接失败: Unable to connect to the remote server
2025-06-13 17:33:29 [INFO] 设置界面失去焦点
2025-06-13 17:33:30 [INFO] 设置界面已激活
2025-06-13 17:33:30 [INFO] 用户确认启用客户端抠像功能
2025-06-13 17:33:30 [INFO] 抠像功能设置更改: 启用
2025-06-13 17:33:31 [INFO] 设置界面失去焦点
2025-06-13 17:33:33 [INFO] 设置界面已激活
2025-06-13 17:33:33 [INFO] 抠像颜色已更改为: R=0, G=255, B=0
2025-06-13 17:33:34 [INFO] 定时检查：主窗体无焦点，尝试重获焦点
2025-06-13 17:33:34 [INFO] 设置界面失去焦点
2025-06-13 17:33:34 [INFO] MainForm 窗体被激活
2025-06-13 17:33:34 [INFO] 重置键盘事件处理
2025-06-13 17:33:34 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:33:34 [INFO] 设置界面已激活
2025-06-13 17:33:34 [INFO] 保存设置并触发SettingsChanged事件
2025-06-13 17:33:34 [INFO] SettingsForm_SettingsChanged 事件触发。
2025-06-13 17:33:34 [INFO] 应用设置中...
2025-06-13 17:33:34 [INFO] 抠像功能已启用
2025-06-13 17:33:34 [INFO] 设置窗口置顶: True
2025-06-13 17:33:34 [INFO] 设置界面失去焦点
2025-06-13 17:33:34 [INFO] MainForm 窗体被激活
2025-06-13 17:33:35 [INFO] 启用点击穿透: True
2025-06-13 17:33:35 [INFO] 点击穿透模式下重新注册全局热键
2025-06-13 17:33:35 [INFO] 已注销所有全局热键
2025-06-13 17:33:35 [INFO] 注册全局热键 Alt+F10: 失败
2025-06-13 17:33:35 [INFO] 注册全局热键 Alt+S: 成功
2025-06-13 17:33:35 [INFO] 设置流URL: http://127.0.0.1:11188/video.html
2025-06-13 17:33:35 [INFO] 成功导航到流URL
2025-06-13 17:33:35 [INFO] 设置应用完成。
2025-06-13 17:33:35 [INFO] 保存应用程序设置。
2025-06-13 17:33:35 [INFO] 尝试连接到 WebSocket 服务器: ws://localhost:8080
2025-06-13 17:33:35 [INFO] 重置键盘事件处理
2025-06-13 17:33:35 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:33:35 [INFO] 抠像脚本注入完成: 启用
2025-06-13 17:33:35 [INFO] 语音合成开始播放。
2025-06-13 17:33:35 [INFO] 语音合成开始播放事件。
2025-06-13 17:33:35 [WARNING] WebSocket 未连接，无法发送消息。
2025-06-13 17:33:35 [ERROR] ERROR: WebSocket 错误: WebSocket 未连接。
2025-06-13 17:33:35 [INFO] 页面导航完成，启用调试模式
2025-06-13 17:33:36 [INFO] MainForm 窗体被激活
2025-06-13 17:33:36 [INFO] 保存后隐藏设置窗口
2025-06-13 17:33:36 [INFO] 设置窗口可见性改变: False
2025-06-13 17:33:36 [INFO] 设置界面已隐藏
2025-06-13 17:33:36 [INFO] 主窗体重新获得焦点
2025-06-13 17:33:36 [INFO] 重新设置主窗体键盘事件处理
2025-06-13 17:33:36 [INFO] 重置键盘事件处理
2025-06-13 17:33:36 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:33:36 [INFO] WebView2调试脚本已注入
2025-06-13 17:33:36 [INFO] 页面加载完成，重新应用抠像效果
2025-06-13 17:33:37 [INFO] 抠像脚本注入完成: 启用
2025-06-13 17:33:37 [INFO] 抠像脚本已重试注入
2025-06-13 17:33:37 [INFO] 语音合成播放完成。
2025-06-13 17:33:37 [INFO] 语音合成播放完成事件。
2025-06-13 17:33:37 [WARNING] WebSocket 未连接，无法发送消息。
2025-06-13 17:33:37 [ERROR] ERROR: WebSocket 错误: WebSocket 未连接。
2025-06-13 17:33:37 [INFO] 抠像脚本注入完成: 启用
2025-06-13 17:33:39 [ERROR] ERROR: WebSocket 连接失败: Unable to connect to the remote server
Exception: Unable to connect to the remote server
StackTrace:    at System.Net.WebSockets.WebSocketHandle.ConnectAsync(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken, ClientWebSocketOptions options)
   at System.Net.WebSockets.ClientWebSocket.ConnectAsyncCore(Uri uri, HttpMessageInvoker invoker, CancellationToken cancellationToken)
   at CoreApplication.WebSocketClient.ConnectAsync(String uri) in D:\Projects\bestHuman\bestHuman\CoreApplication\WebSocketClient.cs:line 56
2025-06-13 17:33:39 [ERROR] ERROR: WebSocket 错误: 连接失败: Unable to connect to the remote server
2025-06-13 17:33:44 [INFO] 定时检查：主窗体拥有焦点，键盘输入正常
2025-06-13 17:33:50 [INFO] MainForm 窗体被激活
2025-06-13 17:33:54 [INFO] 定时检查：主窗体无焦点，尝试重获焦点
2025-06-13 17:33:54 [INFO] MainForm 窗体被激活
2025-06-13 17:33:54 [INFO] 重置键盘事件处理
2025-06-13 17:33:54 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:34:04 [INFO] 定时检查：主窗体无焦点，尝试重获焦点
2025-06-13 17:34:04 [INFO] MainForm 窗体被激活
2025-06-13 17:34:04 [INFO] 重置键盘事件处理
2025-06-13 17:34:04 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:34:14 [INFO] 定时检查：主窗体无焦点，尝试重获焦点
2025-06-13 17:34:14 [INFO] MainForm 窗体被激活
2025-06-13 17:34:14 [INFO] 重置键盘事件处理
2025-06-13 17:34:14 [INFO] 主窗体键盘事件重置完成，KeyPreview=True, Focused=False, Enabled=True, TopLevel=True
2025-06-13 17:34:24 [INFO] 定时检查：主窗体拥有焦点，键盘输入正常
2025-06-13 17:34:26 [INFO] 已注销所有全局热键
2025-06-13 17:34:26 [INFO] 应用程序已关闭。
